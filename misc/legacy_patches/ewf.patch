<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns='http://www.w3.org/1999/xhtml' xml:lang='en' lang='en'>
<head>
<title>disktype.git - disktype</title>
<meta name='generator' content='cgit v0.10.1'/>
<meta name='robots' content='index, nofollow'/>
<link rel='stylesheet' type='text/css' href='/cgit-data/cgit.css'/>
<link rel='shortcut icon' href='/favicon.ico'/>
<link rel='alternate' title='Atom feed' href='http://pkgs.fedoraproject.org/cgit/disktype.git/atom/ewf.patch?h=master' type='application/atom+xml'/>
</head>
<body>
<div id='cgit'><table id='header'>
<tr>
<td class='logo' rowspan='2'><a href='/cgit/'><img src='/cgit-data/cgit.png' alt='cgit logo'/></a></td>
<td class='main'><a href='/cgit/'>index</a> : <a title='disktype.git' href='/cgit/disktype.git/'>disktype.git</a></td><td class='form'><form method='get' action=''>
<input type='hidden' name='id' value='35fbf4e9ca877fe2ab958c40c7a7980b071d58e3'/><select name='h' onchange='this.form.submit();'>
<option value='el5'>el5</option>
<option value='el6'>el6</option>
<option value='epel7'>epel7</option>
<option value='f10'>f10</option>
<option value='f11'>f11</option>
<option value='f12'>f12</option>
<option value='f13'>f13</option>
<option value='f14'>f14</option>
<option value='f15'>f15</option>
<option value='f16'>f16</option>
<option value='f17'>f17</option>
<option value='f18'>f18</option>
<option value='f19'>f19</option>
<option value='f20'>f20</option>
<option value='f21'>f21</option>
<option value='f9'>f9</option>
<option value='master' selected='selected'>master</option>
</select> <input type='submit' name='' value='switch'/></form></td></tr>
<tr><td class='sub'>disktype</td><td class='sub right'>Jesse Keating</td></tr></table>
<table class='tabs'><tr><td>
<a href='/cgit/disktype.git/'>summary</a><a href='/cgit/disktype.git/refs/?id=35fbf4e9ca877fe2ab958c40c7a7980b071d58e3'>refs</a><a href='/cgit/disktype.git/log/ewf.patch'>log</a><a href='/cgit/disktype.git/tree/ewf.patch?id=35fbf4e9ca877fe2ab958c40c7a7980b071d58e3'>tree</a><a href='/cgit/disktype.git/commit/ewf.patch?id=35fbf4e9ca877fe2ab958c40c7a7980b071d58e3'>commit</a><a class='active' href='/cgit/disktype.git/diff/ewf.patch?id=35fbf4e9ca877fe2ab958c40c7a7980b071d58e3'>diff</a><a href='/cgit/disktype.git/stats/ewf.patch'>stats</a></td><td class='form'><form class='right' method='get' action='/cgit/disktype.git/log/ewf.patch'>
<input type='hidden' name='id' value='35fbf4e9ca877fe2ab958c40c7a7980b071d58e3'/><select name='qt'>
<option value='grep'>log msg</option>
<option value='author'>author</option>
<option value='committer'>committer</option>
<option value='range'>range</option>
</select>
<input class='txt' type='text' size='10' name='q' value=''/>
<input type='submit' value='search'/>
</form>
</td></tr></table>
<div class='path'>path: <a href='/cgit/disktype.git/diff/?id=35fbf4e9ca877fe2ab958c40c7a7980b071d58e3'>root</a>/<a href='/cgit/disktype.git/diff/ewf.patch?id=35fbf4e9ca877fe2ab958c40c7a7980b071d58e3'>ewf.patch</a></div><div class='content'><div class='cgit-panel'><b>diff options</b><form method='get' action='.'><input type='hidden' name='id' value='35fbf4e9ca877fe2ab958c40c7a7980b071d58e3'/><table><tr><td colspan='2'/></tr><tr><td class='label'>context:</td><td class='ctrl'><select name='context' onchange='this.form.submit();'><option value='1'>1</option><option value='2'>2</option><option value='3' selected='selected'>3</option><option value='4'>4</option><option value='5'>5</option><option value='6'>6</option><option value='7'>7</option><option value='8'>8</option><option value='9'>9</option><option value='10'>10</option><option value='15'>15</option><option value='20'>20</option><option value='25'>25</option><option value='30'>30</option><option value='35'>35</option><option value='40'>40</option></select></td></tr><tr><td class='label'>space:</td><td class='ctrl'><select name='ignorews' onchange='this.form.submit();'><option value='0' selected='selected'>include</option><option value='1'>ignore</option></select></td></tr><tr><td class='label'>mode:</td><td class='ctrl'><select name='ss' onchange='this.form.submit();'><option value='0' selected='selected'>unified</option><option value='1'>ssdiff</option></select></td></tr><tr><td/><td class='ctrl'><noscript><input type='submit' value='reload'/></noscript></td></tr></table></form></div><div class='diffstat-header'><a href='/cgit/disktype.git/diff/?id=35fbf4e9ca877fe2ab958c40c7a7980b071d58e3'>Diffstat</a> (limited to 'ewf.patch')</div><table summary='diffstat' class='diffstat'><tr><td class='mode'>-rw-r--r--</td><td class='add'><a href='/cgit/disktype.git/diff/ewf.patch?id=35fbf4e9ca877fe2ab958c40c7a7980b071d58e3'>ewf.patch</a></td><td class='right'>225</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 100.0%;'/><td class='rem' style='width: 0.0%;'/><td class='none' style='width: 0.0%;'/></tr></table></td></tr>
</table><div class='diffstat-summary'>1 files changed, 225 insertions, 0 deletions</div><table summary='diff' class='diff'><tr><td><div class='head'>diff --git a/ewf.patch b/ewf.patch<br/>new file mode 100644<br/>index 0000000..9c83f11<br/>--- /dev/null<br/>+++ b/<a href='/cgit/disktype.git/tree/ewf.patch?id=35fbf4e9ca877fe2ab958c40c7a7980b071d58e3'>ewf.patch</a></div><div class='hunk'>@@ -0,0 +1,225 @@</div><div class='add'>+diff -urN disktype-9/disktype.1 disktype-9-ewf/disktype.1</div><div class='add'>+--- disktype-9/disktype.1	2005-02-21 20:46:02.000000000 +0000</div><div class='add'>++++ disktype-9-ewf/disktype.1	2008-05-01 21:24:37.000000000 +0100</div><div class='add'>+@@ -46,7 +46,8 @@</div><div class='add'>+ Linux LVM2 physical volumes, Solaris x86 disklabel (vtoc),</div><div class='add'>+ Solaris SPARC disklabel.</div><div class='add'>+ .It Other structures:</div><div class='add'>+-Debian split floppy header, Linux swap.</div><div class='add'>++Debian split floppy header, Linux swap, Expert Witness Compression Format</div><div class='add'>++(EWF).</div><div class='add'>+ .It Disk images:</div><div class='add'>+ Raw CD image (.bin), Virtual PC hard disk image,</div><div class='add'>+ Apple UDIF disk image (limited).</div><div class='add'>+diff -urN disktype-9/ewf.c disktype-9-ewf/ewf.c</div><div class='add'>+--- disktype-9/ewf.c	1970-01-01 01:00:00.000000000 +0100</div><div class='add'>++++ disktype-9-ewf/ewf.c	2008-05-01 21:11:48.000000000 +0100</div><div class='add'>+@@ -0,0 +1,127 @@</div><div class='add'>++/*</div><div class='add'>++ * ewf.c</div><div class='add'>++ * Layered data source for EWF images via libewf.</div><div class='add'>++ * For use with disktype, Copyright (c) 2003 Christoph Pfisterer</div><div class='add'>++ *</div><div class='add'>++ * Copyright (c) 2007 David Loveall</div><div class='add'>++ *</div><div class='add'>++ * Permission is hereby granted, free of charge, to any person</div><div class='add'>++ * obtaining a copy of this software and associated documentation</div><div class='add'>++ * files (the "Software"), to deal in the Software without</div><div class='add'>++ * restriction, including without limitation the rights to use, copy,</div><div class='add'>++ * modify, merge, publish, distribute, sublicense, and/or sell copies</div><div class='add'>++ * of the Software, and to permit persons to whom the Software is</div><div class='add'>++ * furnished to do so, subject to the following conditions:</div><div class='add'>++ *</div><div class='add'>++ * The above copyright notice and this permission notice shall be</div><div class='add'>++ * included in all copies or substantial portions of the Software.</div><div class='add'>++ *</div><div class='add'>++ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,</div><div class='add'>++ * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF</div><div class='add'>++ * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND</div><div class='add'>++ * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS</div><div class='add'>++ * BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN</div><div class='add'>++ * ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN</div><div class='add'>++ * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</div><div class='add'>++ * SOFTWARE. </div><div class='add'>++ */</div><div class='add'>++</div><div class='add'>++#include "global.h"</div><div class='add'>++</div><div class='add'>++#ifdef USE_LIBEWF</div><div class='add'>++#include &lt;libewf.h&gt;</div><div class='add'>++</div><div class='add'>++/*</div><div class='add'>++ * types</div><div class='add'>++ */</div><div class='add'>++</div><div class='add'>++typedef struct ewf_source {</div><div class='add'>++  SOURCE c;</div><div class='add'>++  LIBEWF_HANDLE *e;</div><div class='add'>++} EWF_SOURCE;</div><div class='add'>++</div><div class='add'>++/*</div><div class='add'>++ * helper functions</div><div class='add'>++ */</div><div class='add'>++</div><div class='add'>++static SOURCE *init_ewf_source(char * const filenames[], uint16_t file_amount);</div><div class='add'>++static int read_block_ewf(SOURCE *s, u8 pos, void *buf);</div><div class='add'>++static void close_ewf(SOURCE *s);</div><div class='add'>++</div><div class='add'>++/*</div><div class='add'>++ * ewf analyzer</div><div class='add'>++ */</div><div class='add'>++</div><div class='add'>++void analyze_ewf(char * const filenames[], uint16_t file_amount)</div><div class='add'>++{</div><div class='add'>++  SOURCE *s;</div><div class='add'>++</div><div class='add'>++  /* create and analyze wrapped source */</div><div class='add'>++  s = init_ewf_source(filenames, file_amount);</div><div class='add'>++  analyze_source(s, 1);</div><div class='add'>++  close_source(s);</div><div class='add'>++}</div><div class='add'>++</div><div class='add'>++/*</div><div class='add'>++ * initialize the ewf source</div><div class='add'>++ */</div><div class='add'>++</div><div class='add'>++static SOURCE *init_ewf_source(char * const filenames[], uint16_t file_amount)</div><div class='add'>++{</div><div class='add'>++  EWF_SOURCE *src;</div><div class='add'>++</div><div class='add'>++  src = (EWF_SOURCE *)malloc(sizeof(EWF_SOURCE));</div><div class='add'>++  if (src == NULL)</div><div class='add'>++    bailout("Out of memory");</div><div class='add'>++  memset(src, 0, sizeof(EWF_SOURCE));</div><div class='add'>++</div><div class='add'>++  src-&gt;e = libewf_open(filenames, file_amount, LIBEWF_OPEN_READ);</div><div class='add'>++  if (src-&gt;e == NULL)</div><div class='add'>++    bailout("Can't open EWF file");</div><div class='add'>++</div><div class='add'>++  src-&gt;c.size_known = 1;</div><div class='add'>++</div><div class='add'>++#if defined( LIBEWF_STRING_DIGEST_HASH_LENGTH_MD5 )</div><div class='add'>++  src-&gt;c.size = libewf_get_media_size(src-&gt;e);</div><div class='add'>++  src-&gt;c.blocksize = libewf_get_bytes_per_sector(src-&gt;e);</div><div class='add'>++#else</div><div class='add'>++  if( libewf_get_media_size( src-&gt;e, &amp;( src-&gt;c.size ) ) != 1 )</div><div class='add'>++    bailout("Unable to get media size of EWF file");</div><div class='add'>++  if( libewf_get_bytes_per_sector( src-&gt;e, (uint32_t *) &amp;( src-&gt;c.blocksize ) ) != 1 )</div><div class='add'>++    bailout("Unable to get sector size of EWF file");</div><div class='add'>++#endif</div><div class='add'>++  src-&gt;c.read_block = read_block_ewf;</div><div class='add'>++  src-&gt;c.close = close_ewf;</div><div class='add'>++</div><div class='add'>++  return (SOURCE *)src;</div><div class='add'>++}</div><div class='add'>++</div><div class='add'>++/*</div><div class='add'>++ * raw read</div><div class='add'>++ */</div><div class='add'>++</div><div class='add'>++static int read_block_ewf(SOURCE *s, u8 pos, void *buf)</div><div class='add'>++{</div><div class='add'>++  EWF_SOURCE *es = (EWF_SOURCE *)s;</div><div class='add'>++</div><div class='add'>++  /* read from lower layer */</div><div class='add'>++  if(libewf_read_random(es-&gt;e, buf, es-&gt;c.blocksize, pos) == -1)  {</div><div class='add'>++    return 0;</div><div class='add'>++  }</div><div class='add'>++</div><div class='add'>++  return 1;</div><div class='add'>++}</div><div class='add'>++</div><div class='add'>++/*</div><div class='add'>++ * cleanup</div><div class='add'>++ */</div><div class='add'>++</div><div class='add'>++static void close_ewf(SOURCE *s)</div><div class='add'>++{</div><div class='add'>++  EWF_SOURCE *es = (EWF_SOURCE *)s;</div><div class='add'>++</div><div class='add'>++  libewf_close(es-&gt;e);</div><div class='add'>++}</div><div class='add'>++</div><div class='add'>++#endif</div><div class='add'>++/* EOF */</div><div class='add'>+diff -urN disktype-9/main.c disktype-9-ewf/main.c</div><div class='add'>+--- disktype-9/main.c	2003-05-24 18:35:44.000000000 +0100</div><div class='add'>++++ disktype-9-ewf/main.c	2008-05-01 21:11:48.000000000 +0100</div><div class='add'>+@@ -27,6 +27,10 @@</div><div class='add'>+ </div><div class='add'>+ #include "global.h"</div><div class='add'>+ </div><div class='add'>++#ifdef USE_LIBEWF</div><div class='add'>++#include &lt;libewf.h&gt;</div><div class='add'>++#endif</div><div class='add'>++</div><div class='add'>+ #ifdef USE_MACOS_TYPE</div><div class='add'>+ #include &lt;CoreServices/CoreServices.h&gt;</div><div class='add'>+ #endif</div><div class='add'>+@@ -38,6 +42,10 @@</div><div class='add'>+ static void analyze_file(const char *filename);</div><div class='add'>+ static void print_kind(int filekind, u8 size, int size_known);</div><div class='add'>+ </div><div class='add'>++#ifdef USE_LIBEWF</div><div class='add'>++void analyze_ewf(char * const filenames[], uint16_t file_amount);</div><div class='add'>++#endif</div><div class='add'>++</div><div class='add'>+ #ifdef USE_MACOS_TYPE</div><div class='add'>+ static void show_macos_type(const char *filename);</div><div class='add'>+ #endif</div><div class='add'>+@@ -59,7 +67,19 @@</div><div class='add'>+   /* loop over filenames */</div><div class='add'>+   print_line(0, "");</div><div class='add'>+   for (i = 1; i &lt; argc; i++) {</div><div class='add'>++#ifndef USE_LIBEWF</div><div class='add'>+     analyze_file(argv[i]);</div><div class='add'>++#endif</div><div class='add'>++#ifdef USE_LIBEWF</div><div class='add'>++    if (libewf_check_file_signature(argv[i]) == 1) {</div><div class='add'>++      print_line(0, "EWF image");</div><div class='add'>++      analyze_ewf(&amp;argv[i], argc-i);</div><div class='add'>++      return 0;</div><div class='add'>++    }</div><div class='add'>++    else {</div><div class='add'>++      analyze_file(argv[i]);</div><div class='add'>++    }</div><div class='add'>++#endif</div><div class='add'>+     print_line(0, "");</div><div class='add'>+   }</div><div class='add'>+ </div><div class='add'>+diff -urN disktype-9/Makefile disktype-9-ewf/Makefile</div><div class='add'>+--- disktype-9/Makefile	2006-01-12 17:55:15.000000000 +0000</div><div class='add'>++++ disktype-9-ewf/Makefile	2008-05-01 21:12:04.000000000 +0100</div><div class='add'>+@@ -9,7 +9,7 @@</div><div class='add'>+          buffer.o file.o cdaccess.o cdimage.o vpc.o compressed.o \</div><div class='add'>+          detect.o apple.o amiga.o atari.o dos.o cdrom.o \</div><div class='add'>+          linux.o unix.o beos.o archives.o \</div><div class='add'>+-         udf.o blank.o cloop.o</div><div class='add'>++         udf.o blank.o cloop.o ewf.o</div><div class='add'>+ </div><div class='add'>+ TARGET = disktype</div><div class='add'>+ </div><div class='add'>+@@ -43,6 +43,11 @@</div><div class='add'>+   endif</div><div class='add'>+ endif</div><div class='add'>+ </div><div class='add'>++ifneq ($(LIBEWF),)</div><div class='add'>++  CPPFLAGS += -DUSE_LIBEWF</div><div class='add'>++  LIBS     += -lewf</div><div class='add'>++endif</div><div class='add'>++</div><div class='add'>+ # real making</div><div class='add'>+ </div><div class='add'>+ all: $(TARGET)</div><div class='add'>+diff -urN disktype-9/Seedfile disktype-9-ewf/Seedfile</div><div class='add'>+--- disktype-9/Seedfile	2006-01-12 17:55:15.000000000 +0000</div><div class='add'>++++ disktype-9-ewf/Seedfile	2008-05-01 21:11:48.000000000 +0100</div><div class='add'>+@@ -7,7 +7,7 @@</div><div class='add'>+          buffer.c file.c cdaccess.c cdimage.c vpc.c compressed.c</div><div class='add'>+          detect.c apple.c amiga.c atari.c dos.c cdrom.c</div><div class='add'>+          linux.c unix.c beos.c archives.c</div><div class='add'>+-         udf.c blank.c cloop.c;</div><div class='add'>++         udf.c blank.c cloop.c ewf.c;</div><div class='add'>+ </div><div class='add'>+   cflags "-D_LARGEFILE_SOURCE" "-D_FILE_OFFSET_BITS=64";</div><div class='add'>+ }</div></td></tr></table></div> <!-- class=content -->
<div class='footer'>generated  by cgit v0.10.1 at 2014-11-09 16:23:57 (GMT)</div>
</div> <!-- id=cgit -->
</body>
</html>
